---
interface Props {
  showTocToggle?: boolean;
}

const { showTocToggle = false } = Astro.props;
const base = import.meta.env.BASE_URL;
---

<header class="sticky top-0 z-50 border-b border-border bg-bg">
  <div class="flex h-14 items-center justify-between px-4">
    <div class="flex items-center gap-4">
      <!-- Left hamburger menu button (mobile only, for sidebar) -->
      <button
        id="menu-toggle"
        class="lg:hidden p-2 -ml-2 hover:bg-bg-secondary rounded-md"
        aria-label="Toggle navigation menu"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="lucide lucide-menu-icon lucide-menu"
          ><path d="M4 5h16"></path><path d="M4 12h16"></path><path d="M4 19h16"
          ></path></svg
        >
      </button>

      <a href={base} class="font-semibold text-lg hover:opacity-80">
        Final Exam Notes
      </a>
    </div>

    <div class="flex items-center gap-2">
      <!-- Right hamburger menu button (mobile only, for TOC) -->
      {
        showTocToggle && (
          <button
            id="toc-toggle"
            class="xl:hidden p-2 hover:bg-bg-secondary rounded-md"
            aria-label="Toggle table of contents"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-table-of-contents-icon lucide-table-of-contents"
            >
              <>
                <path d="M16 5H3" />
                <path d="M16 12H3" />
                <path d="M16 19H3" />
                <path d="M21 5h.01" />
                <path d="M21 12h.01" />
                <path d="M21 19h.01" />
              </>
            </svg>{" "}
          </button>
        )
      }
    </div>
  </div>
</header>

<script>
  function initHeader() {
    const menuToggle = document.getElementById("menu-toggle");
    const sidebar = document.getElementById("sidebar");
    const sidebarOverlay = document.getElementById("sidebar-overlay");

    menuToggle?.addEventListener("click", () => {
      sidebar?.classList.toggle("-translate-x-full");
      sidebarOverlay?.classList.toggle("hidden");
    });

    sidebarOverlay?.addEventListener("click", () => {
      sidebar?.classList.add("-translate-x-full");
      sidebarOverlay?.classList.add("hidden");
    });
  }

  // Run on initial load
  initHeader();

  // Re-run on Astro page transitions
  document.addEventListener("astro:after-swap", initHeader);
</script>
