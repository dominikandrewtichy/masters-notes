---
import { getCollection } from "astro:content";

interface Props {
  currentSlug?: string;
}

const { currentSlug } = Astro.props;
const base = import.meta.env.BASE_URL;

const topics = await getCollection("topics");
const sortedTopics = topics.sort((a, b) => a.data.order - b.data.order);
---

<!-- Mobile overlay -->
<div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden"></div>

<!-- Sidebar -->
<aside
  id="sidebar"
  class="fixed lg:sticky top-14 left-0 z-40 h-[calc(100vh-3.5rem)] w-64 border-r border-border bg-bg transform -translate-x-full lg:translate-x-0 transition-transform duration-200"
>
  <nav class="h-full overflow-y-auto p-4">
    <h2 class="text-sm font-semibold text-text-secondary uppercase tracking-wide mb-3">
      Topics
    </h2>
    <ul class="space-y-1">
      {sortedTopics.map((topic) => {
        const isActive = currentSlug === topic.slug;
        return (
          <li>
            <a
              href={`${base}/topics/${topic.slug}`}
              class:list={[
                "block px-3 py-2 rounded-md text-sm transition-colors",
                isActive
                  ? "bg-bg-secondary font-medium"
                  : "hover:bg-bg-secondary text-text-secondary hover:text-text",
              ]}
            >
              {topic.data.order}. {topic.data.title}
            </a>
          </li>
        );
      })}
    </ul>
  </nav>
</aside>
